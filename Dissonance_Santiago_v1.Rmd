---
title: Do Drivers Dream of Walking? An Investigation of Travel Mode Dissonance from the Perspective of Subjective Wellbeing
author:
  - name: Author 1
    email: a1@university.com
    affiliation: Some University
    footnote: Corresponding Author
  - name: Author 2
    email: a2@school.com
    affiliation: Some School
address:
  - code: Some University
    address: Department, Street, City, State, Zip
  - code: Some School
    address: Department, Street, City, State, Zip
abstract: |
  Transportation in most of the world has been dominated for decades by a fascination with the automobile. Nonetheless, there is an increasing recognition that to achieve a variety of economic, environmental, and public health policy goals it is important to attract and retain active travelers and users of public transportation. A challenge with the way transportation policy is developed, however, is that it tends to focus on utilitarian considerations, which may miss other potential aspects of transportation that users value. In particular, subjective wellbeing (SWB) has been proposed as a way to enhance our understanding of the preferences and choices of travellers, as well as a way to evaluate the benefits of transportation beyond utilitarian considerations. The objective of this paper is to analyze the modes that people commonly use, and to what extent they are aligned (or not) with a variety of affective values associated with SWB. In other words, we are interested in the potential for dissonance with respect to the primary mode of travel, from the perspective of affective values. The study is based on data collected from a sample of travellers in the city of Santiago, in Chile. Participants in the study were asked about their usual mode of travel, and then were asked to name the mode or modes that they associate with the affective values of freedom, enjoyment, happiness, poverty, luxury and status. The results indicate that users of public transportation experience the most dissonance in terms of affective values, and active travellers the least. For those travellers who experience dissonance, active travel is the mode most commonly associated with freedom, enjoyment, and happiness, public transportation is most commonly associated with poverty, and the automobil is most commonly associated with luxury and status.

journal: "An Elsevier journal"
date: "`r Sys.Date()`"
bibliography: mybibfile.bib
#linenumbers: true
#numbersections: true
csl: elsevier-harvard.csl
output: rticles::elsevier_article
---

<!-- This paper is an R markdown document that includes self-contained, reproducible analysis. To reproduce the paper the following files are needed:

1. Dissonance_Santiago_v1.Rmd (this R markdown document)

2. `Dissonance_Santiago.RData`. For reference: this data file was created using R notebook `00. Analysis of Dissonance Detailed.Rmd`. The initial analysis was done in the same R notebook. Neither of these two notebooks are needed for this document. 

3. For compiling into a pdf in the style of an Elsevier document: elsarticle.cls, elsevier-harvard.csl, elsevier-harvard-without-titles.csl, elsevier-vancouver.csl, elsevier-without-titles.cls, elsevier-with-titles.csl, elsevier-with-titles-alphabetical.csl, mybibfile.bib
-->




```{r load-packages, include=FALSE}

# Load packages used in this document

library(rticles)
library(readxl)
library(tidyverse)
library(rgdal)
library(sf)
library(ggmosaic)
library(ggthemes)
library(kableExtra)
library(gridExtra)
```

```{r load-data, include=FALSE}

# To run this notebook, the file `Dissonance_Santiago.RData` is needed. This file contains the following object:
# 
# master: a dataframe with information collected from 451 respondents. The variables in the dataframe are:
# 
# - NUMERO: Respondent ID
# - USED: Main mode of transportation used by the respondent
# - FREEDOM: Mode(s) that the respondent associates with feelings of freedom
# - ENJOYMENT: Mode(s) that the respondent associates with feelings of enjoyment
# - HAPPINESS: Mode(s) that the respondent associates with feelings of happiness
# - POVERTY: Mode(s) that the respondent associates with feelings of poverty
# - LUXURY: Mode(s) that the respondent associates with feelings of luxury
# - STATUS: Mode(s) that the respondent associates with feelings of status
# - SAFETY: Mode(s) that the respondent associates with feelings of safety
# - TIME: Mode(s) that the respondent associates with feelings of WASTED TIME
# - EFFICIENCY: Mode(s) that the respondent associates with feelings of efficiency
# - AGE: Age of the respondent
# - EDUCATION: Level of education of the respondent
# - INCOME: Level of income of respondent
# - TRAVEL_TIME: Trip duration of regular commuting trip 
# - WEIGHT_*: A weight for the responses by ATTRIBUTE. Some respondents selected more than one mode that they associated with feelings of {FREEDOM, ENJOYMENT, HAPPINESS, POVERTY, LUXURY, STATUS, SAFETY, TIME, and EFFICIENCY}. To avoid giving greater weight to respondents who indicated several modes of transportation, a weight was calculated that is the inverse of the number of modes indicated. These weights can be used to weight the frequencies prior to any analysis.
# 
# The modes of transportation (USED, FREEDOM, ENJOYMENT, HAPPINESS, POVERTY, LUXURY, STATUS, SAFETY, TIME, EFFICIENCY) are coded as: 
# "A": Car
# "B": Taxi
# "C": Colectivo
# "D": Moto
# "E": Metro
# "F": Bus
# "G": Bicycle
# "H": Walk
#
# AGE is coded as:
#
# "A": Less18
# "B": 18to24
# "C": 25to34
# "D": 35to54
# "E": 55to64
# "F": 65more
# 
# EDUCATION is coded as:
# 
# "A": ELEMENTARY
# "B": SECUNDARY
# "C": PROFESS_TECH
# "D": COLLEGE
# "E": POSTGRAD
#
# INCOME is coded as (in pesos?):
# 
# "A": Less423
# "B": 423to639
# "C": 639to977
# "D": 977to1550
# "E": 1550to2380
# "F": 2380more
# 
# TRAVEL_TIME is coded as:
#
# "A": 0-20 min
# "B": 20-40 min
# "C": 40-60 min
# "D": 1h and more

# Read the RData file:

load("Dissonance_Santiago.RData")
```

```{r data-preparation, include=FALSE}

# The master dataframe is processed for analysis. We plan to conduct two distinct types of analysis:
#
# 1. Who experiences dissonace?
#
# Analysis of dissonace using the characteristics of respondents (i.e., AGE, EDUCATION, INCOME, (Mode) USED, and TRAVEL_TIME) by ATTRIBUTE (i.e., FREEDOM et al.). In this case, dissonance is defined as follows:
#
# >> If the mode used is identical to the mode that the respondent associates with ATTRIBUTE (i.e. FREEDOM et al.), we consider that there is no dissonance; otherwise, we consider that there is dissonance. For example, if the respondent's main mode of transportation is Car, and the respondent associates Car with feelings of FREEDOM, then there is no dissonance. On the other hand, if the respondent's main mode of transportation is Car, but associates Walking with feelings of FREEDOM, there is dissonance.
# 
# Given this, we will calculate how frequently there is dissonance at different levels of AGE, EDUCATION, INCOME, MODE, TRAVEL_TIME. Tests of independence can be implemented.
#
# 2. For those respondents who experience dissonance, what mode(s) are better aligned with various affective values
#
# Analysis of dissonance using the mode USED and the mode respondents associated with ATTRIBUTE, then stratified by characteristics of respondents (i.e., AGE et al.) in this case, we see how frequently each mode was associated with ATTRIBUTE, given the main mode of transportation of the respondents.
#
# Here the dataframes are prepared to support these two types of analysis

#####################################################################################
# Prepare a dataframe for Analysis 1: Who experiences dissonance by affective value #
#####################################################################################

# First, select the variables needed from the master table, and code dissonance as 1 (no dissonance) or two (dissonance):

Overall_dissonance <- master %>%
  transmute(USED, 
            FREEDOM_DISSONANCE = ifelse(USED == FREEDOM, 1, 2),
            ENJOYMENT_DISSONANCE = ifelse(USED == ENJOYMENT, 1, 2),
            HAPPINESS_DISSONANCE = ifelse(USED == HAPPINESS, 1, 2),
            POVERTY_DISSONANCE = ifelse(USED == POVERTY, 1, 2),
            LUXURY_DISSONANCE = ifelse(USED == LUXURY, 1, 2),
            STATUS_DISSONANCE = ifelse(USED == STATUS, 1, 2),
            SAFETY_DISSONANCE = ifelse(USED == SAFETY, 1, 2),
            TIME_DISSONANCE = ifelse(USED == TIME, 1, 2),
            EFFICIENCY_DISSONANCE = ifelse(USED == EFFICIENCY, 1, 2),
            AGE,
            EDUCATION,
            INCOME,
            TRAVEL_TIME)

# Recode variables and convert to factors:

Overall_dissonance <- Overall_dissonance %>%
  mutate(USED = case_when(USED == "A" ~ "Car",
                                  USED == "B" | USED == "C" | USED == "D" ~ "Other",
                                  USED == "E" | USED == "F" ~ "Public",
                                  USED == "G" | USED == "H" ~ "Active"),
         AGE = case_when(AGE == "A" | AGE == "B" | AGE == "C" ~ "< 35",
                         AGE == "D" ~ "35 - 54",
                         AGE == "E" | AGE == "F" ~ "> 54"),
         EDUCATION = case_when(EDUCATION == "A" | EDUCATION == "B" ~ "K-12",
                               EDUCATION == "C" | EDUCATION == "D" ~ "Tech/Univ",
                               EDUCATION == "E" ~ "Graduate"),
         INCOME = case_when(INCOME == "A" | INCOME == "B" ~ "Low",
                            INCOME == "C" | INCOME == "D" ~ "Middle",
                            INCOME == "E" | INCOME == "F" ~ "High"),
         TRAVEL_TIME = case_when(TRAVEL_TIME == "A" ~ "< 20 min",
                                 TRAVEL_TIME == "B" ~ "20 - 40 min",
                                 TRAVEL_TIME == "C" ~ "40 - 60 min",
                                 TRAVEL_TIME == "D" ~ "> 60 min")) %>%
  mutate(USED = factor(USED, levels = c("Car", "Active", "Public", "Other"), labels = c("Car", "Active", "Public", "Other")),
         FREEDOM_DISSONANCE = factor(FREEDOM_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         ENJOYMENT_DISSONANCE = factor(ENJOYMENT_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         HAPPINESS_DISSONANCE = factor(HAPPINESS_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         POVERTY_DISSONANCE = factor(POVERTY_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         LUXURY_DISSONANCE = factor(LUXURY_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         STATUS_DISSONANCE = factor(STATUS_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         SAFETY_DISSONANCE = factor(SAFETY_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         TIME_DISSONANCE = factor(TIME_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         EFFICIENCY_DISSONANCE = factor(EFFICIENCY_DISSONANCE, levels = c(1, 2), labels = c("No Dissonance", "Dissonance")),
         AGE = factor(AGE, levels = c("< 35", "35 - 54", "> 54"), labels = c("< 35", "35 - 54", "> 54")),
         EDUCATION = factor(EDUCATION, levels = c("K-12", "Tech/Univ", "Graduate"), labels = c("K-12", "Tech/Univ", "Graduate")),
         INCOME = factor(INCOME, levels = c("Low", "Middle", "High"), labels = c("Low", "Middle", "High")),
         TRAVEL_TIME = factor(TRAVEL_TIME, levels = c("< 20 min", "20 - 40 min", "40 - 60 min", "> 60 min"), labels = c("< 20 min", "20 - 40 min", "40 - 60 min", "> 60 min")))

###############################################################################################
# Prepare a dataframe for Analysis 2: What mode(s) align better with various affective values #
###############################################################################################

# First, split the responses regarding the modes associated with each attribute, so that we can record each mode selected individually:

Modes_by_Attribute <- master %>% 
    mutate(FREEDOM = strsplit(as.character(FREEDOM), ""),
           ENJOYMENT = strsplit(as.character(ENJOYMENT), ""),
           HAPPINESS = strsplit(as.character(HAPPINESS), ""),
           POVERTY = strsplit(as.character(POVERTY), ""),
           LUXURY = strsplit(as.character(LUXURY), ""),
           STATUS = strsplit(as.character(STATUS), ""),
           SAFETY = strsplit(as.character(SAFETY), ""),
           TIME = strsplit(as.character(TIME), ""),
           EFFICIENCY = strsplit(as.character(EFFICIENCY), ""))

# Here, we convert each of the responses into an individual row and stack the resulting dataframes, after adding the name of the attribute for identification:

Modes_by_Attribute <- rbind(data.frame(Modes_by_Attribute %>% 
                                         select(-c(ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY, 
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY, 
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>% 
                                         rename(IDEAL = FREEDOM, WEIGHT = WEIGHT_FREEDOM) %>%
                                         unnest(IDEAL),
                                       ATTRIBUTE = "FREEDOM"),
                            data.frame(Modes_by_Attribute %>%
                                         select(-c(FREEDOM, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY, 
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY, 
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>% 
                                         rename(IDEAL = ENJOYMENT, WEIGHT = WEIGHT_ENJOYMENT) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "ENJOYMENT"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY, 
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM,
                                                   WEIGHT_ENJOYMENT,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY, 
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>% 
                                         rename(IDEAL = HAPPINESS, WEIGHT = WEIGHT_HAPPINESS) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "HAPPINESS"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY,
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY,
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>%
                                         rename(IDEAL = POVERTY, WEIGHT = WEIGHT_POVERTY) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "POVERTY"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   #LUXURY,
                                                   STATUS,
                                                   SAFETY,
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   #WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY,
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>%
                                         rename(IDEAL = LUXURY, WEIGHT = WEIGHT_LUXURY) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "LUXURY"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   #STATUS,
                                                   SAFETY,
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   #WEIGHT_STATUS,
                                                   WEIGHT_SAFETY,
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>%
                                         rename(IDEAL = STATUS, WEIGHT = WEIGHT_STATUS) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "STATUS"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   TIME, 
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_TIME, 
                                                   WEIGHT_EFFICIENCY)) %>%
                                         rename(IDEAL = SAFETY, WEIGHT = WEIGHT_SAFETY) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "SAFETY"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY,
                                                   EFFICIENCY,
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY,
                                                   WEIGHT_EFFICIENCY)) %>%
                                         rename(IDEAL = TIME, WEIGHT = WEIGHT_TIME) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "TIME"),
                            data.frame(Modes_by_Attribute %>% 
                                         select(-c(FREEDOM, 
                                                   ENJOYMENT, 
                                                   HAPPINESS,
                                                   POVERTY,
                                                   LUXURY,
                                                   STATUS,
                                                   SAFETY,
                                                   TIME, 
                                                   WEIGHT_FREEDOM, 
                                                   WEIGHT_ENJOYMENT, 
                                                   WEIGHT_HAPPINESS,
                                                   WEIGHT_POVERTY,
                                                   WEIGHT_LUXURY,
                                                   WEIGHT_STATUS,
                                                   WEIGHT_SAFETY,
                                                   WEIGHT_TIME)) %>%
                                         rename(IDEAL = EFFICIENCY, WEIGHT = WEIGHT_EFFICIENCY) %>%
                                         unnest(IDEAL), 
                                       ATTRIBUTE = "EFFICIENCY"))

# There are some missing values. Drop all NAs:

Modes_by_Attribute <- drop_na(Modes_by_Attribute)

# We now recode the variables:

Modes_by_Attribute <- Modes_by_Attribute %>%
  mutate(USED = case_when(USED == "A" ~ "Car",
                                  USED == "B" | USED == "C" | USED == "D" ~ "Other",
                                  USED == "E" | USED == "F" ~ "Public",
                                  USED == "G" | USED == "H" ~ "Active"),
         IDEAL = case_when(IDEAL == "A" ~ "Car",
                                  IDEAL == "B" | IDEAL == "C" | IDEAL == "D" ~ "Other",
                                  IDEAL == "E" | IDEAL == "F" ~ "Public",
                                  IDEAL == "G" | IDEAL == "H" ~ "Active"),
         AGE = case_when(AGE == "A" | AGE == "B" | AGE == "C" ~ "< 35",
                         AGE == "D" ~ "35 - 54",
                         AGE == "E" | AGE == "F" ~ "> 54"),
         EDUCATION = case_when(EDUCATION == "A" | EDUCATION == "B" ~ "K-12",
                               EDUCATION == "C" | EDUCATION == "D" ~ "Tech/Univ",
                               EDUCATION == "E" ~ "Graduate"),
         INCOME = case_when(INCOME == "A" | INCOME == "B" ~ "Low",
                            INCOME == "C" | INCOME == "D" ~ "Middle",
                            INCOME == "E" | INCOME == "F" ~ "High"),
         TRAVEL_TIME = case_when(TRAVEL_TIME == "A" ~ "< 20 min",
                                 TRAVEL_TIME == "B" ~ "20 - 40 min",
                                 TRAVEL_TIME == "C" ~ "40 - 60 min",
                                 TRAVEL_TIME == "D" ~ "> 60 min"))

# After recoding the , there will be some duplicate entries, because a person may have attributed, say, feelings of freedom to walking and cycling, so in the table this will appear as two instances of "Active". This is ok, because each is weighted appropriately.

# Convert to factors:

Modes_by_Attribute <- Modes_by_Attribute %>%
  mutate(USED = factor(USED, levels = c("Car", "Active", "Public", "Other"), labels = c("Car", "Active", "Public", "Other")),
         IDEAL = factor(IDEAL, levels = c("Car", "Active", "Public", "Other"), labels = c("Car", "Active", "Public", "Other")),
         AGE = factor(AGE, levels = c("< 35", "35 - 54", "> 54"), labels = c("< 35", "35 - 54", "> 54")),
         EDUCATION = factor(EDUCATION, levels = c("K-12", "Tech/Univ", "Graduate"), labels = c("K-12", "Tech/Univ", "Graduate")),
         INCOME = factor(INCOME, levels = c("Low", "Middle", "High"), labels = c("Low", "Middle", "High")),
         TRAVEL_TIME = factor(TRAVEL_TIME, levels = c("< 20 min", "20 - 40 min", "40 - 60 min", "> 60 min"), labels = c("< 20 min", "20 - 40 min", "40 - 60 min", "> 60 min")))
```


```{r cross-tabs-function, include=FALSE}

## Define functions for crosstabs; these functions enhance the base crosstabs functions and make it easier to report cross tabulations in different ways.

crosstab <- function (..., dec.places = NULL,
                           type = NULL,
                           style = "wide",
                           row.vars = NULL,
                           col.vars = NULL,
                           percentages = TRUE, 
                           addmargins = TRUE,
                           subtotals=TRUE)

###################################################################################
#                                                                                 #
# Function created by Dr Paul Williamson, Dept. of Geography and Planning,        #
# School of Environmental Sciences, University of Liverpool, UK.                  #
#                                                                                 #
# Adapted from the function ctab() in the catspec packge.                         #
#                                                                                 #
# Version: 12th July 2013                                                         #
#                                                                                 #
# Output best viewed using the companion function print.crosstab()                #
#                                                                                 #
###################################################################################

  
  #Declare function used to convert frequency counts into relevant type of proportion or percentage
  {mk.pcnt.tbl <- function(tbl, type) {
        a <- length(row.vars)
        b <- length(col.vars)
        mrgn <- switch(type, column.pct = c(row.vars[-a], col.vars), 
                            row.pct = c(row.vars, col.vars[-b]),
                            joint.pct = c(row.vars[-a], col.vars[-b]),
                            total.pct = NULL)
        tbl <- prop.table(tbl, mrgn)
        if (percentages) {
            tbl <- tbl * 100
        }
        tbl
    }
        
    #Find no. of vars (all; row; col) for use in subsequent code
    n.row.vars <- length(row.vars)
    n.col.vars <- length(col.vars)
    n.vars <- n.row.vars + n.col.vars
    

    #Check to make sure all user-supplied arguments have valid values
    stopifnot(as.integer(dec.places) == dec.places, dec.places > -1)
    #type: see next section of code
    stopifnot(is.character(style))    
    stopifnot(is.logical(percentages))
    stopifnot(is.logical(addmargins))
    stopifnot(is.logical(subtotals))
    stopifnot(n.vars>=1)

    #Convert supplied table type(s) into full text string (e.g. "f" becomes "frequency")
    #If invalid type supplied, failed match gives user automatic error message
    types <- NULL
    choices <- c("frequency", "row.pct", "column.pct", "joint.pct", "total.pct")
    for (tp in type) types <- c(types, match.arg(tp, choices))
    type <- types
  
    #If no type supplied, default to 'frequency + total' for univariate tables and to
    #'frequency' for multi-dimenstional tables

    #For univariate table....
    if (n.vars == 1) {
      if (is.null(type)) {
        # default = freq count + total.pct  
        type <- c("frequency", "total.pct")
        #row.vars <- 1
      } else {
        #and any requests for row / col / joint.pct must be changed into requests for 'total.pct'
        type <- ifelse(type == "frequency", "frequency", "total.pct")
      }
    #For multivariate tables...
    } else if (is.null(type)) {
      # default = frequency count  
      type <- "frequency"
    }
    
      
    
    #Check for integrity of requested analysis and adjust values of function arguments as required
    
    if ((addmargins==FALSE) & (subtotals==FALSE)) {
      warning("WARNING: Request to suppress subtotals (subtotals=FALSE) ignored because no margins requested (addmargins=FALSE)")
      subtotals <- TRUE
    }
          
    if ((n.vars>1) & (length(type)>1) & (addmargins==TRUE)) {
      warning("WARNING: Only row totals added when more than one table type requested")
      #Code lower down selecting type of margin implements this...
    }

    if ((length(type)>1) & (subtotals==FALSE)) { 
      warning("WARNING: Can only request supply one table type if requesting suppression of subtotals; suppression of subtotals not executed")
      subtotals <- TRUE
    }
    
    if ((length(type)==1) & (subtotals==FALSE)) {
      choices <- c("frequency", "row.pct", "column.pct", "joint.pct", "total.pct")
      tp <- match.arg(type, choices)
      if (tp %in% c("row.pct","column.pct","joint.pct")) {
          warning("WARNING: subtotals can only be suppressed for tables of type 'frequency' or 'total.pct'")
          subtotals<- TRUE
         }
    }
    
    if ((n.vars > 2) & (n.col.vars>1) & (subtotals==FALSE)) 
      warning("WARNING: suppression of subtotals assumes only 1 col var; table flattened accordingly")
    
    
    if ( (subtotals==FALSE) & (n.vars>2) )  {
    #If subtotals not required AND total table vars > 2
    #Reassign all but last col.var as row vars
    #[because, for simplicity, crosstabs assumes removal of subtotals uses tables with only ONE col var]
    #N.B. Subtotals only present in tables with > 2 cross-classified vars...
      if (length(col.vars)>1) {
        row.vars <- c(row.vars,col.vars[-length(col.vars)])
        col.vars <- col.vars[length(col.vars)]
        n.row.vars <- length(row.vars)
        n.col.vars <- 1
      }
    }
    
    #If dec.places not set by user, set to 2 unlesss only one table of type frequency requested,
    #in which case set to 0.  [Leaves user with possibility of having frequency tables with > 0 dp]
    if (is.null(dec.places)) {
      if ((length(type)==1) & (type[1]=="frequency")) {
        dec.places <- 0
      } else {
        dec.places <-2
      }
    }
 
    #Take the original input data, whatever form originally supplied in,
    #convert into table format using requested row and col vars, and save as 'tbl'

    args <- list(...)    
    
    if (length(args) > 1) {
        if (!all(sapply(args, is.factor))) 
            stop("If more than one argument is passed then all must be factors")
        tbl <- table(...)
    }
    else {
        if (is.factor(...)) {
            tbl <- table(...)
        }
        else if (is.table(...)) {
            tbl <- eval(...)
        }
        else if (is.data.frame(...)) {
            #tbl <- table(...)
            if (is.null(row.vars) && is.null(col.vars)) {
              tbl <- table(...)
            }
            else {
              var.names <- c(row.vars,col.vars)
              A <- (...)
              tbl <- table(A[var.names])
              if(length(var.names==1)) names(dimnames(tbl)) <- var.names
              #[table() only autocompletes dimnames for multivariate crosstabs of dataframes]
            }
        }
        else if (class(...) == "ftable") {
            tbl <- eval(...)
            if (is.null(row.vars) && is.null(col.vars)) {
                row.vars <- names(attr(tbl, "row.vars"))
                col.vars <- names(attr(tbl, "col.vars"))
            }
            tbl <- as.table(tbl)
        }
        else if (class(...) == "ctab") {
            tbl <- eval(...)
            if (is.null(row.vars) && is.null(col.vars)) {
                row.vars <- tbl$row.vars
                col.vars <- tbl$col.vars
            }
            for (opt in c("dec.places", "type", "style", "percentages", 
                "addmargins", "subtotals")) if (is.null(get(opt))) 
                assign(opt, eval(parse(text = paste("tbl$", opt, 
                  sep = ""))))
            tbl <- tbl$table
        }
        else {
            stop("first argument must be either factors or a table object")
        }
    }
    
    #Convert supplied table style into full text string (e.g. "l" becomes "long")
    style <- match.arg(style, c("long", "wide"))

    #Extract row and col names to be used in creating 'tbl' from supplied input data
    nms <- names(dimnames(tbl))
    z <- length(nms)
    if (!is.null(row.vars) && !is.numeric(row.vars)) {
        row.vars <- order(match(nms, row.vars), na.last = NA)
    }
    if (!is.null(col.vars) && !is.numeric(col.vars)) {
        col.vars <- order(match(nms, col.vars), na.last = NA)
    }
    if (!is.null(row.vars) && is.null(col.vars)) {
        col.vars <- (1:z)[-row.vars]
    }
    if (!is.null(col.vars) && is.null(row.vars)) {
        row.vars <- (1:z)[-col.vars]
    }
    if (is.null(row.vars) && is.null(col.vars)) {
        col.vars <- z
        row.vars <- (1:z)[-col.vars]
    }
    
    #Take the original input data, converted into table format using supplied row and col vars (tbl)
    #and create a second version (crosstab) which stores results as percentages if a percentage table type is requested.
    if (type[1] == "frequency") 
      crosstab <- tbl
    else 
      crosstab <- mk.pcnt.tbl(tbl, type[1])

    
    #If multiple table types requested, create and add these to 
    if (length(type) > 1) {
      tbldat <- as.data.frame.table(crosstab)
      z <- length(names(tbldat)) + 1
      tbldat[z] <- 1
      pcntlab <- type
      pcntlab[match("frequency", type)] <- "Count"
      pcntlab[match("row.pct", type)] <- "Row %"
      pcntlab[match("column.pct", type)] <- "Column %"
      pcntlab[match("joint.pct", type)] <- "Joint %"
      pcntlab[match("total.pct", type)] <- "Total %"
      for (i in 2:length(type)) {
          if (type[i] == "frequency") 
              crosstab <- tbl
          else crosstab <- mk.pcnt.tbl(tbl, type[i])
          crosstab <- as.data.frame.table(crosstab)
          crosstab[z] <- i
          tbldat <- rbind(tbldat, crosstab)
      }
      tbldat[[z]] <- as.factor(tbldat[[z]])
      levels(tbldat[[z]]) <- pcntlab
      crosstab <- xtabs(Freq ~ ., data = tbldat)
      names(dimnames(crosstab))[z - 1] <- ""
    }
    
        
    #Add margins if required, adding only those margins appropriate to user request
    if (addmargins==TRUE) {

      vars <- c(row.vars,col.vars)
      
      if (length(type)==1) {
      if (type=="row.pct") 
        { crosstab <- addmargins(crosstab,margin=c(vars[n.vars]))
          tbl <- addmargins(tbl,margin=c(vars[n.vars]))
        }
      else 
        { if (type=="column.pct") 
            { crosstab <- addmargins(crosstab,margin=c(vars[n.row.vars]))
              tbl <- addmargins(tbl,margin=c(vars[n.row.vars]))
            }
          else 
            { if (type=="joint.pct") 
              { crosstab <- addmargins(crosstab,margin=c(vars[(n.row.vars)],vars[n.vars])) 
                tbl <- addmargins(tbl,margin=c(vars[(n.row.vars)],vars[n.vars])) 
              }
              else #must be total.pct OR frequency
                { crosstab <- addmargins(crosstab)
                  tbl <- addmargins(tbl)
                }
            }
  	     } 
      }
      
      #If more than one table type requested, only adding row totals makes any sense...
      if (length(type)>1) {
        crosstab <- addmargins(crosstab,margin=c(vars[n.vars]))
        tbl <- addmargins(tbl,margin=c(vars[n.vars]))
      }
      
    }  
    
    
    #If subtotals not required, and total vars > 2, create dataframe version of table, with relevent
    #subtotal rows / cols dropped [Subtotals only present in tables with > 2 cross-classified vars]
    t1 <- NULL
    if ( (subtotals==FALSE) & (n.vars>2) )  {
    
    #Create version of crosstab in ftable format
    t1 <- crosstab 
    t1 <- ftable(t1,row.vars=row.vars,col.vars=col.vars)

    #Convert to a dataframe
    t1 <- as.data.frame(format(t1),stringsAsFactors=FALSE)

    #Remove backslashes from category names AND colnames
    t1 <- apply(t1[,],2, function(x) gsub("\"","",x))
    #Remove preceding and trailing spaces from category names to enable accurate capture of 'sum' rows/cols
    #[Use of grep might extrac category labels with 'sum' as part of a longer one or two word string...]
    t1 <- apply(t1,2,function(x) gsub("[[:space:]]*$","",gsub("^[[:space:]]*","",x)))

    #Reshape dataframe to that variable and category labels display as required
    #(a) Move col category names down one row; and move col variable name one column to right
    t1[2,(n.row.vars+1):ncol(t1)] <- t1[1,(n.row.vars+1):ncol(t1)]
    t1[1,] <- ""
    t1[1,(n.row.vars+2)] <- t1[2,(n.row.vars+1)]    
    #(b) Drop the now redundant column separating the row.var labels from the table data + col.var labels
    t1 <- t1[,-(n.row.vars+1)]
    
    #In 'lab', assign category labels for each variable to all rows (to allow identification of sub-totals) 
    lab <- t1[,1:n.row.vars]
    for (c in 1:n.row.vars) {
      for (r in 2:nrow(lab)) {
        if (lab[r,c]=="") lab[r,c] <- lab[r-1,c]  
      }
    }

    lab <- (apply(lab[,1:n.row.vars],2,function(x) x=="Sum"))
    lab <- apply(lab,1,sum)
    #Filter out rows of dataframe containing subtotals
    
    t1 <- t1[((lab==0) | (lab==n.row.vars)),]

    #Move the 'Sum' label associated with last row to the first column; in the process
    #setting the final row labels associated with other row variables to ""
    t1[nrow(t1),1] <- "Sum"
    t1[nrow(t1),(2:n.row.vars)] <- ""
    
    #set row and column names to NULL
    rownames(t1) <- NULL
    colnames(t1) <- NULL

    }
    
    
    
    #Create output object 'result' [class: crosstab]
    result <- NULL
    #(a) record of argument values used to produce tabular output
    result$row.vars <- row.vars
    result$col.vars <- col.vars
    result$dec.places <- dec.places
    result$type <- type
    result$style <- style
    result$percentages <- percentages
    result$addmargins <- addmargins
    result$subtotals <- subtotals
    
    #(b) tabular output [3 variants]
    result$table <- tbl  #Stores original cross-tab frequency counts without margins [class: table]
    result$crosstab <- crosstab #Stores cross-tab in table format using requested style(frequency/pct) and table margins (on/off)
                                #[class: table]  
    result$crosstab.nosub <- t1  #crosstab with subtotals suppressed [class: dataframe; or NULL if no subtotals suppressed]  
    class(result) <- "crosstab"    

    #Return 'result' as output of function
    result
}
```

1. Introduction
==========================

Transportation planning for decades has focused on providing mobility for the private automobile. This is a model of development that was initially introduced in North America as a solution to problems created by rapid urbanization, and that was eventually copied elsewhere [@Brown2009planning;@Angotti1996latin]. Despite the initial promise of automotive technology, it is now evident that mobility centred on the private automobile has given rise to a litany of maladies that are in urgent need of correction. This includes environmental concerns [i.e., climate change; @Chapman2007transport] as well as numerous other social [@Boschman2008toward; @Lucas2012transport; @Lucas2019evolution], health [@Khreis2016health; @Milne2012public], and equity issues [@Bocarejo2012transport; @Martens2012justice; @Pereira2017distributive].

As the real impacts of our societal dependence on the private autombobile have become increasingly evident, the transportation agenda has aimed to shift focus to the reduction of car use and towards the creation of mobility polycultures that offer a broader menu of transportation alternatives than primarily (or even just) the private automobile [@Miller2011collaborative]. In order to successfully achieve this goal, it is essential not only to provide the services and facilities that support public transportation and active travel, but also to attract new users to these modes of transportation [@Ettema2011satisfaction]. Within this context, it has been argued that sustainable transportation policies require all participants in the transportation system to challenge what Gossling and Cohen [-@Gossling2014sustainable] termed _transportation taboos_: deep-seated ideas concerning the contribution to emissions by individuals, the inequality of market-based approaches, and the social and psychological functions of transportation. With respect to the latter, it is important to move beyond a purely utilitarian focus if we are to understand how the affective value of the transportation experience can be leveraged to improve alternative transportation - particularly transit and active modes [@Anable2005work; @Domarchi2008effect; @Gatersleben2007affective; @Steg2005car]. 

A useful lens to investigate the social and psychological functions of transportation is by means of the concept of subjective wellbeing [SWB; see, inter alia, @Devos2013travel; and @Chatterjee2019commuting]. SWB is defined by the OECD as “[g]ood mental states, including all of the various evaluations, positive and negative, that people make of their lives, and the affective reactions of people to their experiences” (**OECD, 2013, p. 10**). As memorably put by Steg [-@Steg2005car]: is the use of car a must, or is it a lust? A close alignment, or consonance, between affective values and the mode of transportation used to travel can result in greater subjective wellbeing and increase the probability of choosing that mode  (i.e., by satisfying the _lust_); on the other hand, dissonance, that is, the lack of concordance between the mode used and affective values would be detrimental to subjective wellbeing, especially of those for whom the use of the mode is a _must_ [@Devos2019satisfaction; @Mokhtarian2018travel]. With these considerations in mind, one aim of the present research is to investigate _who_ experiences dissonance with respect to their primary mode of travel and affective values, namely freedom, enjoyment, happiness, feelings of poverty, luxury, and status. Furthermore, it is possible, even if use of a particular mode is a _must_, that travellers may still _lust_ for something else - in other words, the grass may in fact look greener from the window of the car. For this reason, we also aim to investigate which mode or modes are most commonly associated with affective values, with a focus on those travellers who experience dissonance in their primary mode.

Research is based on data collected from a sample of travellers in the city of Santiago in Chile. Survey respondents were asked about their primary mode of travel, and also about the mode or modes that they associate with the affective values mentioned above. The paper contributes to the literature in three ways, as follows: 

1. The research reported here contributes to an emerging literature on the topic of transportation and affective values in the context of the Global South [@Alayyash2019commute; @Bejarano2017user; @Shao2019analysis; @Van2014effect; @Zorrilla2019exploring]; to the best of our knowledge, the case of Chile has not yet been reported. 

2. Although there is an extensive literature on the enjoyment of commute and other affective values [see for instance @Paez2010enjoyment; @Redmond2001positive; @Whalen2013mode; @Ye2017satisfaction], from a hedonic and even eudaimonic perspectives the analysis has yet to be applied more fully in terms of distributional issues – i.e. which groups more commonly experience dissonance [see @Devos2018people].

3. The analysis shows the attitudes of people towards their primary mode and their perception towards ‘ideal modes’ – implying their preferences, even in situations when their ideal mode is not part of their actual choice set. More concretely, the results indicate that users of public transportation experience the most dissonance in terms of affective values, and active travellers the least. For those travellers who experience dissonance, active travel is the mode most commonly associated with freedom, enjoyment, and happiness, public transportation is most commonly associated with poverty, and the automobil is most commonly associated with luxury and status. We also find that there are some substantial variations in dissonance by age, education, income, and typical commute time. The attitudes of travellers towards transport modes are critical factors to be considered by policy-makers in case they want to promote and increase the use of public transport or active modes [@Bornioli2019affective; @Devos2017travel; @Devos2019satisfying; @Garling2019role; @Redman2013quality]. 

2. Background
============

A consensus has emerged in the transportation community regarding the need to complement the traditional utilitarian perspective of transportation by looking at mobility and transport issues from the lens of their affective functions. The affective value of transportation in turn is important due to its potential to improve or detract from SWB. One of the primary ways to explore this has been the satisfaction that travelers feel towards their every day mobility experience [e.g., @Bergstad2011subjective]. As a consequence, there is a wealth of research on satisfaction with the use of different modes of transportation. For example, numerous studies report that car users often have a higher level of satisfaction compared to other transport modes [@Bergstad2011affective; @Eriksson2013perceived; @Redmond2001positive; @Whalen2013mode; but see @Handy2019commute]. In a similar way, there are multiple reports that active travel also tends to yield high levels of satisfaction [@Gatersleben2007affective; @Smith2017commute; @Stlouis2014happy; @Paez2010enjoyment; @Whalen2013mode; @Handy2019commute], In contrast, public transport users tend to assess their experience more negatively [@Abenoza2017travel; @Devos2016travel; @Gatersleben2007affective; @Handy2019commute; @Paez2010enjoyment]. Multi-modal trips also influence satisfaction levels; for instance, when an individual chooses a particular mode of transportation, she will report a higher level of satisfaction with that chosen mode – perhaps as a form of _post hoc_ validation [@Susilo2014exploring].

While the use of travel satisfaction has been mainly used in the context of daily trips – typically linked to cost-benefit and utilitarian measurements –, the evaluation of Subjective Wellbeing (SWB) over time has risen as an alternative measure. In the field of travel behaviour, Ettema et al. [-@Ettema2010out, p. 725] define SWB as the degree to which an individual positively evaluates the overall quality of their lives, where the general life satisfaction encompasses a more extended temporality – which implies assuming a tendency to be more stable over time. This concept has prompted a growing literature that complements and applies SWB in a broader range of satisfaction scales and situations. The definition of other factors such as travel choice mode, attitudes and external elements of the built environment have been studied for a broader understanding of the changes produced in the SWB [e.g., @Handy2019commute]. As these factors do not necessarily apply to the general life satisfaction on the long term, the studies have aimed to determine both the direct and indirect effects on the perception of users [see, e.g., @Ye2017satisfaction]. Other concepts have also emerged as the Satisfaction with Travel Scale (STS), a measurement devised by Ettema et al. [-@Ettema2011satisfaction], as well as different scales based on people’s travel perceptions. De Vos et al. [-@Devos2015satisfying], for instance, explore in detail the underlying dimensions of the affective domain of STS on which SWB is based [for more on STS see also @Friman2013psychometric].

Recent literature on SWB and its link with transport have demonstrated a relationship between people’s perceptions and satisfaction with their daily travel [e.g., @Smith2017commute; @Stlouis2014happy; @Mokhtarian2018travel]. Scholars have shown that accessibility has been the most developed factor that influences people’s wellbeing [@Delbosc2012role], and activities have a direct impact on travel satisfaction [@Bergstad2011subjective]. Delbosc [-@Delbosc2012role, p. 28], for instance, has summarised the most significant influences on psychological wellbeing: poverty and employment, meaningful relationships and health. However, understanding the components affecting people’s perceptions implies the differentiation between affective (also named as symbolic-affective) and instrumental values [@Bergstad2011affective]. Steg et al. (2011) have compared symbolic-affective opposed to instrumental-reasoned motives based on car-use, and other studies have also found associations between affective and symbolic aspects of car-use [see, e.g., @Gatersleben2007affective; @Lois2009relationship]. Previous studies have also demonstrated how socio-demographic factors affect the levels of SWB. The effect of income on SWB [@Clark1996satisfaction; @Ferrer2005income]; education and unemployment [@Argyle1999causes]; age [@Diener1997subjective], and gender [@Tesch2008gender] have been extensively studied. Recent research also suggests the links between commuting, SWB and emotional wellbeing assessment (**Olson et al. 2013**; **Kahneman et al. 2004**). However, more research is needed to understand how these socio-demographic variables connect as well with the affective responses to mode of travel [@Stlouis2014happy]. 

The research needs already recognized in the developed world are also markedly acute in the context of the Global South, where historical inequality has tended to create a symbolic attachment to the automobile, in addition to negative connotations for public transport and active travel [@Zorrilla2019exploring]. In this way, there is an emerging literature that investigates affective factors in travel behaviour in a number of developing countries. A cross-country study in Asia revealed that the affective factors of public transportation and car use are important, and in particular the social orderliness of transit was suggested as a way to make this mode more attractive to users [@Van2014effect]. In terms of active travel, a study in China found that attitudes that embrace new styles and technologies despite their cost are associated with the intention to continue using shared bicycles [@Shao2019analysis]. The importance of affective factors for policy and planning is further highlighted by research in Colombia that shows how users felt proud using a bicycle shared system, in addition to experiencing feelings of belonging to a civic culture and the enjoyment and pleasure of travel itself [@Bejarano2017user]. This paper contributes to further our understanding of affective values in travel behaviour in a developing country.

3. Data and Methods
===================

# 3.1 Context

Words to describe Santiago go here.

# 3.2 Sample

The study is based on a survey conducted in the city of Santiago during the months of November and December 2016, that is, the end of the Spring and beginning of Summer. The survey collected information on a wide range of travel and related issues. The data collection considered a quota-sampling method for gathering the information, considering the socio-demographic information from Pre-Census of 2012. An equal representation of both genders and a representation of the proportion of inhabitants per area were chosen as relevant characteristics of the sample. In total, there were $n=451$ valid surveys, although not every survey was complete and there were missing responses for some answers. 

The survey was structured in eight sections, as follows: 1) Individual characteristics of respondent; 2) Health; 3) Feelings and emotions; 4) Reasons for travel and planning travel; 5) Social interaction; 6) Nature and sustainability; 7) Information and telecommunications; 8) Built environment; and 9) Commuting. For the present study, we draw data from sections 1), 3) and 9). In terms of individual characteristics of the respondents and their commute, participants were asked about basic socio-demographic information, including age, level of education, income, and the typical duration of their regular commute. The descriptive statistics of the sample appear in Figure \ref{fig:descriptive-statistics}. The sample tends to be younger, and well-educated, with an almost uniform distribution of income levels. The trend in typical commute time is towards longer commutes.

```{r plot-descriptive-statistics, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:descriptive-statistics}Descriptive statistics of the sample"}

# Bar plots with descriptive statistics for the sample

age_plot <- ggplot(data = drop_na(Overall_dissonance), aes(x = AGE)) +
  geom_bar() +
  theme_tufte() +
  xlab("Age of respondents") +
  theme(axis.text.x = element_text(angle = 90))

education_plot <- ggplot(data = drop_na(Overall_dissonance), aes(x = EDUCATION)) +
  geom_bar() +
  theme_tufte() +
  xlab("Education level of respondents") +
  theme(axis.text.x = element_text(angle = 90))

income_plot <- ggplot(data = drop_na(Overall_dissonance), aes(x = INCOME)) +
  geom_bar() +
  theme_tufte() +
  xlab("Income level of respondents") +
  theme(axis.text.x = element_text(angle = 90))

time_plot <- ggplot(data = drop_na(Overall_dissonance), aes(x = TRAVEL_TIME)) +
  geom_bar() +
  theme_tufte() +
  xlab("Duration of regular commute") +
  theme(axis.text.x = element_text(angle = 90))

grid.arrange(age_plot, education_plot, income_plot, time_plot)
```

In addition, respondents were asked about their primary mode of travel for their regular commute. The modes available were Car, Taxi, Colectivo (a form of shared ride, intermediate in flexibility and capacity between taxi and bus); Motorcycle; Metro; Bus; Bicycle; Walking. As seen in the top panel of Figure \ref{fig:primary-mode-travel}, the three most common modes of travel are Metro, Bus, and Car, followed by Walking and Biycle. For the analysis, we aggregate these modes into the following categories (bottom panel of Figure \ref{fig:primary-mode-travel}): Car, Active (Walking + Bicycle), Public (Metro + Bus), and Other (Taxi + Colectivo + Motorcycle).  

```{r figure-primary-mode-travel, fig.width= 4, fig.height=6, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:primary-mode-travel}Frequency of primary mode used for regular commute; top panel: all modes, bottom panel: aggregated modes"}
mode_plot1 <- ggplot(data = master, aes(x = factor(USED, levels = c("A", "B", "C", "D", "E", "F", "G", "H"),
                                     labels = c("Car", "Taxi", "Colectivo", "Motorcycle", "Metro", "Bus", "Bicycle", "Walk")))) +
  geom_bar() +
  xlab("Primary Mode of Travel") +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))

mode_plot2 <- ggplot(data = Overall_dissonance, aes(x = USED)) +
  geom_bar() +
  xlab("Primary Mode of Travel") +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))

grid.arrange(mode_plot1, mode_plot2, nrow = 2)
```

Of particular interest for the present study is the following question in Part 3) of the survey:

>> Q: Please indicate the mode(s) of transport that you relate to the following feelings and concepts

The question was asked for each of the following affective values: Freedom; Enjoyment; Happiness; Poverty; Luxury; and Status. The respondents were not constrained to select only one alternative, but could indicate by means of a checkbox any and all modes that they felt aligned with each affective value. This allows us to do an analysis of modal dissonance, a concept introduced into the transportation literature by Schwanen and Mokhtarian [-@Schwanen2004extent] based on earlier work by Feldman [-@Feldman1990settlement]. Residential neighborhood-type dissonance was defined by Schwanen and Mokhtarian [-@Schwanen2004extent] as an incongruence in terms of the the land use patterns at the place of residence of an individual, and the individual's preferences. The concept of dissonance has since been extended in the travel behavior literature to encompass the mismatch between the choices individuals make, and the alternatives that would enable users to experience affective or instrumental values. This includes, for example, travel mode dissonance [@Devos2018people]. 

Based on the primary mode of travel and the questions about affective values, we derived a series of travel mode dissonance variables according to the following rule:
$$
D_i = 
\begin{cases}
0 & if \text{ primary mode} = \text{mode associated with value } i\\
1 & \text{ otherwise}
\end{cases}
$$
Therefore, if a respondent's primary mode of travel is Car, but indicated any other mode or modes in relation to Freedom, the respondent experienced dissonance:
$$
D_{\text{Freedom}} = 1
$$

Furthermore, we also expanded the responses to account for all modes identified by respondents in relation to the affective values. However, to avoid double counting the respondents in our frequency tabulations, we also calculated a sample weight that was the inverse of the number of modes selected in response to each affective value. For instance, if a respondent selected two modes in relation to affective value $i$, the two modes receive a weight of $1/2$; if a respondent selected three modes, then their weights are $1/3$; and so on. In this way we do not treat unfairly those who selected only one mode, and the sum of all weighted modes is equal to the sample size.

4. Analysis and Results
==========

In what follows, analysis is done on two related but distinct questions. The first part of the analysis seeks to understand _who_ experiences dissonance, and the second part, building off that, aims to explore which modes of travel are more commonly identified as embodying affective values by those travellers who experience dissonance.

Please note that this document was prepared using R Markdown and contains reproducible analysis. The R markdown file, along with the data file needed to reproduce the analysis, can be downloaded from the following anonymous Drive folder:

https://drive.google.com/open?id=189ZvfVvRis5xZA9IlviKCLW2bwbPJAgg

```{r cross-with-instrumental, include=FALSE, eval=FALSE}

# Create cross tabulations by each respondent characteristic (i.e., AGE, EDUCATION, INCOME, mode USED, and TRAVEL_TIME)

## Age

age_by_freedom <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "FREEDOM_DISSONANCE", type = "r")
age_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
age_by_happiness <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "HAPPINESS_DISSONANCE", type = "r")
age_by_safety <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "SAFETY_DISSONANCE", type = "r")
age_by_time <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "TIME_DISSONANCE", type = "r")
age_by_efficiency <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "EFFICIENCY_DISSONANCE", type = "r")

## Education

education_by_freedom <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "FREEDOM_DISSONANCE", type = "r")
education_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
education_by_happiness <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "HAPPINESS_DISSONANCE", type = "r")
education_by_safety <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "SAFETY_DISSONANCE", type = "r")
education_by_time <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "TIME_DISSONANCE", type = "r")
education_by_efficiency <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "EFFICIENCY_DISSONANCE", type = "r")

## Income

income_by_freedom <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "FREEDOM_DISSONANCE", type = "r")
income_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
income_by_happiness <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "HAPPINESS_DISSONANCE", type = "r")
income_by_safety <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "SAFETY_DISSONANCE", type = "r")
income_by_time <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "TIME_DISSONANCE", type = "r")
income_by_efficiency <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "EFFICIENCY_DISSONANCE", type = "r")

## Mode

mode_by_freedom <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "FREEDOM_DISSONANCE", type = "r")
mode_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
mode_by_happiness <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "HAPPINESS_DISSONANCE", type = "r")
mode_by_safety <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "SAFETY_DISSONANCE", type = "r")
mode_by_time <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "TIME_DISSONANCE", type = "r")
mode_by_efficiency <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "EFFICIENCY_DISSONANCE", type = "r")

## Travel Time

time_by_freedom <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "FREEDOM_DISSONANCE", type = "r")
time_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
time_by_happiness <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "HAPPINESS_DISSONANCE", type = "r")
time_by_safety <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "SAFETY_DISSONANCE", type = "r")
time_by_time <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "TIME_DISSONANCE", type = "r")
time_by_efficiency <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "EFFICIENCY_DISSONANCE", type = "r")

```

```{r cross-without-instrumental, include=FALSE}

# Create cross tabulations by each respondent characteristic (i.e., AGE, EDUCATION, INCOME, mode USED, and TRAVEL_TIME)

## Age

age_by_freedom <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "FREEDOM_DISSONANCE", type = "r")
age_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
age_by_happiness <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "HAPPINESS_DISSONANCE", type = "r")
age_by_poverty <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "POVERTY_DISSONANCE", type = "r")
age_by_luxury <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "LUXURY_DISSONANCE", type = "r")
age_by_status <- crosstab(Overall_dissonance, row.vars = "AGE", col.vars = "STATUS_DISSONANCE", type = "r")

## Education

education_by_freedom <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "FREEDOM_DISSONANCE", type = "r")
education_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
education_by_happiness <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "HAPPINESS_DISSONANCE", type = "r")
education_by_poverty <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "POVERTY_DISSONANCE", type = "r")
education_by_luxury <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "LUXURY_DISSONANCE", type = "r")
education_by_status <- crosstab(Overall_dissonance, row.vars = "EDUCATION", col.vars = "STATUS_DISSONANCE", type = "r")

## Income

income_by_freedom <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "FREEDOM_DISSONANCE", type = "r")
income_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
income_by_happiness <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "HAPPINESS_DISSONANCE", type = "r")
income_by_poverty <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "POVERTY_DISSONANCE", type = "r")
income_by_luxury <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "LUXURY_DISSONANCE", type = "r")
income_by_status <- crosstab(Overall_dissonance, row.vars = "INCOME", col.vars = "STATUS_DISSONANCE", type = "r")

## Mode

mode_by_freedom <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "FREEDOM_DISSONANCE", type = "r")
mode_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
mode_by_happiness <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "HAPPINESS_DISSONANCE", type = "r")
mode_by_poverty <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "POVERTY_DISSONANCE", type = "r")
mode_by_luxury <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "LUXURY_DISSONANCE", type = "r")
mode_by_status <- crosstab(Overall_dissonance, row.vars = "USED", col.vars = "STATUS_DISSONANCE", type = "r")

## Travel Time

time_by_freedom <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "FREEDOM_DISSONANCE", type = "r")
time_by_enjoyment <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "ENJOYMENT_DISSONANCE", type = "r")
time_by_happiness <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "HAPPINESS_DISSONANCE", type = "r")
time_by_poverty <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "POVERTY_DISSONANCE", type = "r")
time_by_luxury <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "LUXURY_DISSONANCE", type = "r")
time_by_status <- crosstab(Overall_dissonance, row.vars = "TRAVEL_TIME", col.vars = "STATUS_DISSONANCE", type = "r")

```

```{r collect-cross-tabulation-results-with-instrumental, include=FALSE, eval=FALSE}

# Collect the cross tabulations for each of the respondent's characteristics and the ATTRIBUTES

## Age

age_results <- cbind(age_by_freedom$crosstab, 
                     age_by_enjoyment$crosstab, 
                     age_by_happiness$crosstab,
                     age_by_safety$crosstab,
                     age_by_time$crosstab,
                     age_by_efficiency$crosstab)

# Drop the row totals
age_results <- age_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(age_results) <- c("Freedom", "Enjoyment", "Happiness", "Safety", "Time", "Efficiency")

# Convert to dataframe and make the rownames a variable
age_results <- age_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
age_results <- age_results %>%
  mutate(chi2.freedom = summary(age_by_freedom$table)$p.value,
         chi2.enjoyment = summary(age_by_enjoyment$table)$p.value,
         chi2.happiness = summary(age_by_happiness$table)$p.value,
         chi2.safety = summary(age_by_safety$table)$p.value,
         chi2.time = summary(age_by_time$table)$p.value,
         chi2.efficiency = summary(age_by_efficiency$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Safety,
         chi2.safety,
         Time,
         chi2.time,
         Efficiency,
         chi2.efficiency)

## Education

education_results <- cbind(education_by_freedom$crosstab, 
                     education_by_enjoyment$crosstab, 
                     education_by_happiness$crosstab,
                     education_by_safety$crosstab,
                     education_by_time$crosstab,
                     education_by_efficiency$crosstab)

# Drop the row totals
education_results <- education_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(education_results) <- c("Freedom", "Enjoyment", "Happiness", "Safety", "Time", "Efficiency")

# Convert to dataframe and make the rownames a variable
education_results <- education_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
education_results <- education_results %>%
  mutate(chi2.freedom = summary(education_by_freedom$table)$p.value,
         chi2.enjoyment = summary(education_by_enjoyment$table)$p.value,
         chi2.happiness = summary(education_by_happiness$table)$p.value,
         chi2.safety = summary(education_by_safety$table)$p.value,
         chi2.time = summary(education_by_time$table)$p.value,
         chi2.efficiency = summary(education_by_efficiency$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Safety,
         chi2.safety,
         Time,
         chi2.time,
         Efficiency,
         chi2.efficiency)

## Income

income_results <- cbind(income_by_freedom$crosstab, 
                     income_by_enjoyment$crosstab, 
                     income_by_happiness$crosstab,
                     income_by_safety$crosstab,
                     income_by_time$crosstab,
                     income_by_efficiency$crosstab)

# Drop the row totals
income_results <- income_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(income_results) <- c("Freedom", "Enjoyment", "Happiness", "Safety", "Time", "Efficiency")

# Convert to dataframe and make the rownames a variable
income_results <- income_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
income_results <- income_results %>%
  mutate(chi2.freedom = summary(income_by_freedom$table)$p.value,
         chi2.enjoyment = summary(income_by_enjoyment$table)$p.value,
         chi2.happiness = summary(income_by_happiness$table)$p.value,
         chi2.safety = summary(income_by_safety$table)$p.value,
         chi2.time = summary(income_by_time$table)$p.value,
         chi2.efficiency = summary(income_by_efficiency$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Safety,
         chi2.safety,
         Time,
         chi2.time,
         Efficiency,
         chi2.efficiency)

## Mode USED

mode_results <- cbind(mode_by_freedom$crosstab, 
                     mode_by_enjoyment$crosstab, 
                     mode_by_happiness$crosstab,
                     mode_by_safety$crosstab,
                     mode_by_time$crosstab,
                     mode_by_efficiency$crosstab)

# Drop the row totals
mode_results <- mode_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(mode_results) <- c("Freedom", "Enjoyment", "Happiness", "Safety", "Time", "Efficiency")

# Convert to dataframe and make the rownames a variable
mode_results <- mode_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
mode_results <- mode_results %>%
  mutate(chi2.freedom = summary(mode_by_freedom$table)$p.value,
         chi2.enjoyment = summary(mode_by_enjoyment$table)$p.value,
         chi2.happiness = summary(mode_by_happiness$table)$p.value,
         chi2.safety = summary(mode_by_safety$table)$p.value,
         chi2.time = summary(mode_by_time$table)$p.value,
         chi2.efficiency = summary(mode_by_efficiency$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Safety,
         chi2.safety,
         Time,
         chi2.time,
         Efficiency,
         chi2.efficiency)

## Time

time_results <- cbind(time_by_freedom$crosstab, 
                     time_by_enjoyment$crosstab, 
                     time_by_happiness$crosstab,
                     time_by_safety$crosstab,
                     time_by_time$crosstab,
                     time_by_efficiency$crosstab)

# Drop the row totals
time_results <- time_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(time_results) <- c("Freedom", "Enjoyment", "Happiness", "Safety", "Time", "Efficiency")

# Convert to dataframe and make the rownames a variable
time_results <- time_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
time_results <- time_results %>%
  mutate(chi2.freedom = summary(time_by_freedom$table)$p.value,
         chi2.enjoyment = summary(time_by_enjoyment$table)$p.value,
         chi2.happiness = summary(time_by_happiness$table)$p.value,
         chi2.safety = summary(time_by_safety$table)$p.value,
         chi2.time = summary(time_by_time$table)$p.value,
         chi2.efficiency = summary(time_by_efficiency$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Safety,
         chi2.safety,
         Time,
         chi2.time,
         Efficiency,
         chi2.efficiency)
```

```{r collect-cross-tabulation-results-without-instrumental, include=FALSE}

# Collect the cross tabulations for each of the respondent's characteristics and the ATTRIBUTES

## Age

age_results <- cbind(age_by_freedom$crosstab, 
                     age_by_enjoyment$crosstab, 
                     age_by_happiness$crosstab,
                     age_by_poverty$crosstab,
                     age_by_luxury$crosstab,
                     age_by_status$crosstab)

# Drop the row totals
age_results <- age_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(age_results) <- c("Freedom", "Enjoyment", "Happiness", "Poverty", "Luxury", "Status")

# Convert to dataframe and make the rownames a variable
age_results <- age_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
age_results <- age_results %>%
  mutate(chi2.freedom = summary(age_by_freedom$table)$p.value,
         chi2.enjoyment = summary(age_by_enjoyment$table)$p.value,
         chi2.happiness = summary(age_by_happiness$table)$p.value,
         chi2.poverty = summary(age_by_poverty$table)$p.value,
         chi2.luxury = summary(age_by_luxury$table)$p.value,
         chi2.status = summary(age_by_status$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Poverty,
         chi2.poverty,
         Luxury,
         chi2.luxury,
         Status,
         chi2.status)

## Education

education_results <- cbind(education_by_freedom$crosstab, 
                     education_by_enjoyment$crosstab, 
                     education_by_happiness$crosstab,
                     education_by_poverty$crosstab,
                     education_by_luxury$crosstab,
                     education_by_status$crosstab)

# Drop the row totals
education_results <- education_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(education_results) <- c("Freedom", "Enjoyment", "Happiness", "Poverty", "Luxury", "Status")

# Convert to dataframe and make the rownames a variable
education_results <- education_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
education_results <- education_results %>%
  mutate(chi2.freedom = summary(education_by_freedom$table)$p.value,
         chi2.enjoyment = summary(education_by_enjoyment$table)$p.value,
         chi2.happiness = summary(education_by_happiness$table)$p.value,
         chi2.poverty = summary(education_by_poverty$table)$p.value,
         chi2.luxury = summary(education_by_luxury$table)$p.value,
         chi2.status = summary(education_by_status$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Poverty,
         chi2.poverty,
         Luxury,
         chi2.luxury,
         Status,
         chi2.status)

## Income

income_results <- cbind(income_by_freedom$crosstab, 
                     income_by_enjoyment$crosstab, 
                     income_by_happiness$crosstab,
                     income_by_poverty$crosstab,
                     income_by_luxury$crosstab,
                     income_by_status$crosstab)

# Drop the row totals
income_results <- income_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(income_results) <- c("Freedom", "Enjoyment", "Happiness", "Poverty", "Luxury", "Status")

# Convert to dataframe and make the rownames a variable
income_results <- income_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
income_results <- income_results %>%
  mutate(chi2.freedom = summary(income_by_freedom$table)$p.value,
         chi2.enjoyment = summary(income_by_enjoyment$table)$p.value,
         chi2.happiness = summary(income_by_happiness$table)$p.value,
         chi2.poverty = summary(income_by_poverty$table)$p.value,
         chi2.luxury = summary(income_by_luxury$table)$p.value,
         chi2.status = summary(income_by_status$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Poverty,
         chi2.poverty,
         Luxury,
         chi2.luxury,
         Status,
         chi2.status)

## Mode USED

mode_results <- cbind(mode_by_freedom$crosstab, 
                     mode_by_enjoyment$crosstab, 
                     mode_by_happiness$crosstab,
                     mode_by_poverty$crosstab,
                     mode_by_luxury$crosstab,
                     mode_by_status$crosstab)

# Drop the row totals
mode_results <- mode_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(mode_results) <- c("Freedom", "Enjoyment", "Happiness", "Poverty", "Luxury", "Status")

# Convert to dataframe and make the rownames a variable
mode_results <- mode_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
mode_results <- mode_results %>%
  mutate(chi2.freedom = summary(mode_by_freedom$table)$p.value,
         chi2.enjoyment = summary(mode_by_enjoyment$table)$p.value,
         chi2.happiness = summary(mode_by_happiness$table)$p.value,
         chi2.poverty = summary(mode_by_poverty$table)$p.value,
         chi2.luxury = summary(mode_by_luxury$table)$p.value,
         chi2.status = summary(mode_by_status$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Poverty,
         chi2.poverty,
         Luxury,
         chi2.luxury,
         Status,
         chi2.status)

## Time

time_results <- cbind(time_by_freedom$crosstab, 
                     time_by_enjoyment$crosstab, 
                     time_by_happiness$crosstab,
                     time_by_poverty$crosstab,
                     time_by_luxury$crosstab,
                     time_by_status$crosstab)

# Drop the row totals
time_results <- time_results[,c(2, 5, 8, 11, 14, 17)]

# Change column names
colnames(time_results) <- c("Freedom", "Enjoyment", "Happiness", "Poverty", "Luxury", "Status")

# Convert to dataframe and make the rownames a variable
time_results <- time_results %>%
  as.data.frame() %>%
  rownames_to_column()

# Add significance of chi2 tests
time_results <- time_results %>%
  mutate(chi2.freedom = summary(time_by_freedom$table)$p.value,
         chi2.enjoyment = summary(time_by_enjoyment$table)$p.value,
         chi2.happiness = summary(time_by_happiness$table)$p.value,
         chi2.poverty = summary(time_by_poverty$table)$p.value,
         chi2.luxury = summary(time_by_luxury$table)$p.value,
         chi2.status = summary(time_by_status$table)$p.value) %>%
  dplyr::select(rowname, 
         Freedom, 
         chi2.freedom,
         Enjoyment,
         chi2.enjoyment,
         Happiness,
         chi2.happiness,
         Poverty,
         chi2.poverty,
         Luxury,
         chi2.luxury,
         Status,
         chi2.status)
```

```{r crosstab-all-results-with-instrumental, include=FALSE, eval=FALSE}

# Here we bind all the results into a single dataframe for printing

xtab_results <- rbind(age_results,
                      education_results,
                      income_results,
                      mode_results,
                      time_results) %>%
  mutate(chi2.freedom = ifelse(chi2.freedom >= 0.001, paste0(round(chi2.freedom, 4)), "$<0.001$"),
         chi2.enjoyment = ifelse(chi2.enjoyment >= 0.001, paste0(round(chi2.enjoyment, 4)), "$<0.001$"),
         chi2.happiness = ifelse(chi2.happiness >= 0.001, paste0(round(chi2.happiness, 4)), "$<0.001$"),
         chi2.safety = ifelse(chi2.safety >= 0.001, paste0(round(chi2.safety, 4)), "$<0.001$"),
         chi2.time = ifelse(chi2.time >= 0.001, paste0(round(chi2.time, 4)), "$<0.001$"),
         chi2.efficiency = ifelse(chi2.efficiency >= 0.001, paste0(round(chi2.efficiency, 4)), "$<0.001$"))

xtab_results[10:13, 3] <- "$< 0.001$" # Edit the format of these cells to avoid six cells collapsing together in table
```

```{r crosstab-all-results-without-instrumental, echo=FALSE}

# Here we bind all the results into a single dataframe for printing

xtab_results <- rbind(age_results,
                      education_results,
                      income_results,
                      mode_results,
                      time_results) %>%
  mutate(chi2.freedom = ifelse(chi2.freedom >= 0.001, paste0(round(chi2.freedom, 4)), "$<0.001$"),
         chi2.enjoyment = ifelse(chi2.enjoyment >= 0.001, paste0(round(chi2.enjoyment, 4)), "$<0.001$"),
         chi2.happiness = ifelse(chi2.happiness >= 0.001, paste0(round(chi2.happiness, 4)), "$<0.001$"),
         chi2.poverty = ifelse(chi2.poverty >= 0.001, paste0(round(chi2.poverty, 4)), "$<0.001$"),
         chi2.luxury = ifelse(chi2.luxury >= 0.001, paste0(round(chi2.luxury, 4)), "$<0.001$"),
         chi2.status = ifelse(chi2.status >= 0.001, paste0(round(chi2.status, 4)), "$<0.001$"))

xtab_results[10:13, 3] <- "$< 0.001$" # Edit the format of these cells to avoid six cells collapsing together in table
```

# 4.1 Who experiences dissonance?

To investigate the first question in our analysis, we create contingency tables that tabulate the frequency of dissonance with respect to each affective value, stratified by the attributes of Age, Education, Income, Primary Mode of Travel, and typical Commute Time. Table \ref{tab:cross-tabulation-results-without-instrumental} presents the frequency (in percentage) of dissonance, in other words, the percentage of respondents out of the total in their stratum who indicated mode or mode(s) for the affective value that do not correspond to their primary mode of travel.

As seen in the table, there are five characteristics of the respondents and their commutes that we use in the analysis. Three of these categories are socio-economic and demographic, namely age, level of education, and income. The other two are transportation related, namely primary mode of travel and commute time. The frequency tables were tested in every case by means of the $\chi^2$ test of independence ($p$-values are reported in the table; lower $p$-values mean that the null hypothesis of independence can be rejected with greater confidence). It is interesting to note that the only category for which all affective values are significant at better than 5% level of confidence is mode of travel.

### 4.1.1 Age

With respect to Age, previous studies have reported that older adults tend to be more satisfied with their travel experience than younger people [@Cao2014satisfaction; @Devos2016travel; @Ye2017satisfaction]. In the case, we find that five affective values show dissonance that significantly deviates from the null hypothesis of independence, namely Freedom, Enjoyment, Happiness, Luxury, and Status. We observe that levels of dissonance tend to be high in general, and in no case less than 60%. For instance, almost 90% of travellers younger than 35 experience travel mode dissonance with respect to Freedom, and more than 94% experience dissonance with respect to enjoyment. In general, younger travellers tend to experience dissonance more frequently, with dissonance being less frequent for older travellers. The exception to this trend is Luxury, an affective value for which older travellers (age >54) experience dissonance more frequently than mid-aged travellers (ages 35-54).

### 4.1.2 Education

When seen from the perspective of Education, the results do not support the hypothesis of  significant differences in the frequency of dissonance by levels of education for the values of Freedom, Enjoyment, Happiness, and Poverty, and only two affective values show significant differences between education levels: Luxury and Status. In the case of Luxury, dissonance is more frequent among people who have only K-12 education, and less frequently, albeit still high, for people with technical/university level education and post-graduate education. Furthermore, highly educated people (with postgraduate degrees) experience dissonance with respect to Status more frequently than with respect to Luxury.

### 4.1.3 Income

The next variable we examine is income, and in this case three affective values are significant: Poverty, Luxury, and Status. Since Poverty is a negative affect, we see here that lower income people tend to associate this feeling to their primary mode of commuting more frequently (almost 20% of the time) than other income groups. For example, whereas approximately 16% of mid-income people are dissatisfied with their primary mode of travel in this respect, less than 7% of high income individuals are. Dissonance with respect to Luxury and Status also tends to be more common among lower income people, and declines substantially for mid- and high income respondents. Notice as well that the frequency of dissonance is higher in terms of Luxury than Status for mid- and high income people.

### 4.1.4 Primary mode of travel

The variable that shows the largest differences in the frequency of dissonance is the primary mode of travel. It can be seen in Table \ref{tab:cross-tabulation-results-without-instrumental} that the differences are significative for all six affective values. Dissonance is particularly accute for users of public transportation when it comes to the values of Freedom, Enjoyment, and Happiness: almost 100% of users of public transportation have identified other mode or modes as better representing those values. Dissonance on these values is the least for active travellers: less than 50% of respondents associate Freedom to a different mode, and only around 60% identified a different mode when responding to the values of Enjoyment and Happiness, compared to approximately 79% and 71% of those who travelled by Car. The picture changes when the values of Poverty, Luxury, and Status are considered. In this case, dissonance is less frequent for people who travel by car: less than 3% of car users associate car with feelings of poverty, 41% associate Luxury with a mode other than car, and only about 31% relate Status to a different mode. Dissonance is more frequent in these values for active travellers, and users of public transportation and other modes, in no case being less than 75%, and being virtually 100% for users of public transportation, who consistently associate Luxury and Status with modes _other_ than public transportation. 

### 4.1.5 Typical commute time

Turning now to typical commute time, four affectie values show significant differences at better than 10% confidence: Freedom, Happiness, Luxury, and Status. Perhaps not surprisingly, dissonance is more frequent among people whose typical commutes are longer. This is in line with previous findings: both St-Louis et al. [-@Stlouis2014happy] and Smith [-@Smith2017commute] report that commute satisfaction tends to decline with longer commutes, whereas Handy and Thigpen [-@Handy2019commute] found that commute distance was a negative covariate of commute satisfaction. 

```{r table-cross-tabulation-results-with-instrumental, echo = FALSE, eval=FALSE}
kable(xtab_results,
      "latex",
      digits = 2,
      booktabs = TRUE,
      caption = "\\label{tab:cross-tabulation-results-with-instrumental}Percentage of respondents who report mode dissonance with respect to various SWB and instrumental factors",
      escape = FALSE,
      align = c("l", rep("c", 12)),
      col.names = c("Variable", 
                    "Freedom", "$\\chi^2$ p-val", 
                    "Enjoyment", "$\\chi^2$ p-val",
                    "Happiness", "$\\chi^2$ p-val",
                    "Safety", "$\\chi^2$ p-val",
                    "Time", "$\\chi^2$ p-val",
                    "Efficiency", "$\\chi^2$ p-val")) %>%
  collapse_rows(columns = c(3, 5, 7, 9, 11, 13), latex_hline = "major", valign = "middle") %>%
  pack_rows("Age", 1, 3) %>%
  pack_rows("Education", 4, 6) %>%
  pack_rows("Income", 7, 9) %>%
  pack_rows("Mode", 10, 13) %>%
  pack_rows("Commute Time", 14, 17)  %>%
  kable_styling(bootstrap_options = c("striped", "scaled_down")) %>%
  landscape()
```

```{r table-cross-tabulation-results-without-instrumental, echo = FALSE}
kable(xtab_results,
      "latex",
      digits = 2,
      booktabs = TRUE,
      caption = "\\label{tab:cross-tabulation-results-without-instrumental}Percentage of respondents who report mode dissonance with respect to various SWB and instrumental factors",
      escape = FALSE,
      align = c("l", rep("c", 12)),
      col.names = c("Variable", 
                    "Freedom", "$\\chi^2$ p-val", 
                    "Enjoyment", "$\\chi^2$ p-val",
                    "Happiness", "$\\chi^2$ p-val",
                    "Poverty", "$\\chi^2$ p-val",
                    "Luxury", "$\\chi^2$ p-val",
                    "Status", "$\\chi^2$ p-val")) %>%
  collapse_rows(columns = c(3, 5, 7, 9, 11, 13), latex_hline = "major", valign = "middle") %>%
  pack_rows("Age", 1, 3) %>%
  pack_rows("Education", 4, 6) %>%
  pack_rows("Income", 7, 9) %>%
  pack_rows("Mode", 10, 13) %>%
  pack_rows("Commute Time", 14, 17)  %>%
  kable_styling(bootstrap_options = c("striped", "scaled_down")) %>%
  landscape()
```

**FOR DISCUSSION**

@Alayyash2019commute
@Bornioli2019affective
@Devos2019satisfying
@Gatersleben2007affective
@Smith2017commute
@Ye2017satisfaction

## 4.2 Which modes do travellers associate with affective values?

The preceding analysis suggests that there is significant mode dissonance along various dimensions and for various affective values. Once we have developed a profile of the travelers who experience mode dissonance, we are interested in what modes they tend to associate with various affective values. For this analysis, we employ a visualization technique known as a mosaic plot that is used for exploring categorical data [@Friendly1994mosaic; @Hofmann2000exploring]. A mosaic plot is a visual representation of a multi-way contingency table, whereby the dimensions of each tile in the mosaic are proportional to the values in the underlying table. 

We begin by plotting the cross-tabulation of primary mode of travel to mode associated with each affective value (see Figure \ref{fig:mosaic-plots-by-attribute}). The height of tile $j$ in these mosaics corresponds to the proportion of travellers who primarily travel by mode $j$, hence we can see that the most common primary mode of travel in this sample is by public transportation, followed by car, active travel, and other (also see Figure \ref{fig:primary-mode-travel}). Notice that there are some small discrepancies in the heights across affective values: these are caused by a small number of non-responses. Next, the width of the tile $k$ in the mosaics is proportional to the frequency with which a mode was named in relation to affective value $i$. Recall that respondents could nominate more than one mode in response to each affective value, and some did. For this reason, we used sampling weights, so that the total number of responses corresponds to the size of the sample.

In terms of Freedom, we see that Car users frequently identify this affect with the use of Car; however, those who do not, very often select Active Travel as the mode that better represents Freedom. A majority of active travellers, on the other hand, identify Active Travel as the mode associated with Freedom; few of them attach this value to Car, and even fewer to public transportation and other modes. Travellers whose primary mode of travel is public transportation seldom associate this mode with Freedom, and in fact more frequently relate this affective response to Active Travel followed by Car. Users of other modes seem to be split almost equally in their attribution of Freedom, between Active Travel, Car, and Other. In general, Active Travel is the mode most often identified as embodying Freedom, with the exception of Car travellers.

The pattern with respect to Enjoyment is similar to that for Freedom, but with an even more decisive tilt towards Active Travel, with even more respondents whose primary mode of travel is Car choosing Active Travel as the mode that better represents Enjoyment. Notice that very few of Active Travelers selected Car as an enjoyable mode. Likewise, compared to Freedom, Active Travel is perceived as being more enjoyable by users of Public Transportatoin and Other modes. Responses with respect to Happiness are somewhere in between Freedom and Enjoyment, but Happiness is, if anything, even less frequently identified with Public Transportation.

Three other affective responses show a marked difference. Public Transportation was seldom associated by respondents to feelings of Freedom, Enjoyment, and Happiness; on the other hand, it is the mode that is most commonly selected by respondents for evoking feelings of Poverty - even by users of Publi Transportation. Active Travel was the second most common response for its association with Poverty. Likewise, Whereas Active Travel was often associated to feelings of Freedom, Enjoyment, and Happiness, the mode most frequently associated with Luxury and Status is the Car, although active travellers seem to be somewhat more resistant to this association compared to respondents who travel by Car, Public Transportation, and Other modes.

Next, we further explore these responses after stratifying by Age, Education, Income, and Commute Time. We test the underlying 3-way tables by means of the Cochran-Mantel-Haenszel $\chi^2$ test of independence.

***

Efectivamente lujo y estatus parecen similares a primera vista (Figura 1). En general, estos dos valores afectivos son asociados mucho mas comunmente con el automovil. Por otro lado, hay algunas diferencias interesantes cuando se les ve desde la perspectiva de diferentes viajeros.

Por ejemplo, la tendencia a asociar estatus con el automovil tiende a incrementarse con la edad, con la posible excepcion de los usuarios de transporte publico, para quienes otras opciones (posiblemente taxi), ganan en estatus para los viajeros mayores (>54) a costa de otros modos, incluido el automovil. En contraste, el automovil pierde en el valor de lujo con la edad, mientras que otras opciones pasan a ser percibidas como lujo mas comunmente con la edad, incluso para los usuarios de automovil (Figure 2). 

se vuelven mas comunmente simbolos de estatus que cuando vemos la manera en que viajeros de diferentes edades proyectan lujo y estatus en varios modos, los usuarios de automovil mayores (>54) muestran menos disonancia en status que en lujo, mientras que los viajeros activos presentan mas disonancia en estatus que en lujo, y de hecho proyectan estatus mas comunmente en el automovil. 

La manera en que el lujo se asocia de manera relativamente mas frecuente con otras opciones que el estatus tambien se observa cuando vemos los diferentes niveles de educacion. La excepcion parece ser los usuarios de transporte activo, especialmente  aquellos con educacion superior y de post-grado, que asocian tanto estatus como lujo con el transporte activo mas que los usuarios de otros modos.

***

```{r figure-mosaic-plots-by-attribute-with-instrumental, echo=FALSE, cache = TRUE, eval=FALSE, fig.cap="\\label{fig:mosaic-plots-by-attribute-with-instrumental}Mosaic plots for three affective and three instrumental values; values on the x-axis represent proportion of modes selected for each value, and values on the y-axis represent proportion of respondents by main mode of transportation"}

ggplot(data = Modes_by_Attribute) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode selected for the value of {Freedom, Enjoyment, Happiness, Safety, Time, Efficiency}") +
  ylab("Main mode of transportation") +
  scale_fill_viridis_d(direction = -1) +
  facet_wrap(~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```


```{r figure-mosaic-plots-by-attribute, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:mosaic-plots-by-attribute}Mosaic plots for affective values; the y-axis is the proportion of respondents by main mode of transportation, and the x-axis is the proportion of modes selected for each value"}

ggplot(data = Modes_by_Attribute %>% filter(ATTRIBUTE %in% c("FREEDOM", "ENJOYMENT", "HAPPINESS", "POVERTY", "LUXURY", "STATUS"))) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode associated with {Freedom, Enjoyment, Happiness, Poverty, Luxury, Status}") +
  ylab("Primary mode of travel") +
  scale_fill_viridis_d(direction = -1) +
  facet_wrap(~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```

### 4.2.1 Age

Words go here to discuss results by age.

```{r figure-mosaic-plots-by-attribute-and-age, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:mosaic-plots-by-age}Mosaic plots for affective values by age; the y-axis is the proportion of respondents by main mode of transportation, and the x-axis is the proportion of modes selected for each value (p-values are for Cochran-Mantel-Haenszel Chi-Squared Test)"}

# Select only values that were significant in the tests of independence

# Also, use Cochran-Mantel-Haenzel tests
# Freedom
Modes_by_Freedom_by_Age <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + AGE, data = filter(Modes_by_Attribute, ATTRIBUTE == "FREEDOM")))

# Enjoyment
Modes_by_Enjoyment_by_Age <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + AGE, data = filter(Modes_by_Attribute, ATTRIBUTE == "ENJOYMENT")))

# Happiness
Modes_by_Happiness_by_Age <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + AGE, data = filter(Modes_by_Attribute, ATTRIBUTE == "HAPPINESS")))

# Luxury
Modes_by_Luxury_by_Age <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + AGE, data = filter(Modes_by_Attribute, ATTRIBUTE == "LUXURY")))

# Status
Modes_by_Status_by_Age <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + AGE, data = filter(Modes_by_Attribute, ATTRIBUTE == "STATUS")))

labels <- c(paste('FREEDOM\np-value', ifelse(round(Modes_by_Freedom_by_Age$p.value, 2) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Age$p.value, 3)),
                                             " < 0.001")),
            paste('ENJOYMENT\np-value', ifelse(round(Modes_by_Freedom_by_Age$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Age$p.value, 3)),
                                             " < 0.001")),
            paste('HAPPINESS\np-value', ifelse(round(Modes_by_Freedom_by_Age$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Age$p.value, 3)),
                                             " < 0.001")),
            paste('LUXURY\np-value', ifelse(round(Modes_by_Freedom_by_Age$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Age$p.value, 3)),
                                             " < 0.001")),
            paste('STATUS\np-value', ifelse(round(Modes_by_Freedom_by_Age$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Age$p.value, 3)),
                                             " < 0.001")))


ggplot(data = Modes_by_Attribute %>% 
         filter(ATTRIBUTE %in% c("FREEDOM", "ENJOYMENT", "HAPPINESS", "LUXURY", "STATUS")) %>%
         mutate(ATTRIBUTE = factor(ATTRIBUTE, 
                                   levels = c("FREEDOM", "ENJOYMENT", "HAPPINESS", "LUXURY", "STATUS"),
                                   labels = labels))) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode associated with {Freedom, Enjoyment, Happiness, Luxury, Status}") +
  ylab("Primary mode of travel") +
  scale_fill_viridis_d(direction = -1) +
  facet_grid(AGE ~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```

### 4.2.2 Education

Words go here to discuss results by education.

```{r figure-mosaic-plots-by-attribute-and-education, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:mosaic-plots-by-education}Mosaic plots for affective values by education; the y-axis is the proportion of respondents by main mode of transportation, and the x-axis is the proportion of modes selected for each value (p-values are for Cochran-Mantel-Haenszel Chi-Squared Test)"}

# Select only values that were significant in the tests of independence

# Also, use Cochran-Mantel-Haenzel tests
# Luxury
Modes_by_Luxury_by_Education <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + EDUCATION, data = filter(Modes_by_Attribute, ATTRIBUTE == "LUXURY")))

# Status
Modes_by_Status_by_Education <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + EDUCATION, data = filter(Modes_by_Attribute, ATTRIBUTE == "STATUS")))

labels <- c(paste('LUXURY\np-value', ifelse(round(Modes_by_Luxury_by_Education$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Luxury_by_Education$p.value, 3)),
                                             " < 0.001")),
            paste('STATUS\np-value', ifelse(round(Modes_by_Status_by_Education$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Status_by_Education$p.value, 3)),
                                             " < 0.001")))


ggplot(data = Modes_by_Attribute %>% 
         filter(ATTRIBUTE %in% c("LUXURY", "STATUS")) %>%
         mutate(ATTRIBUTE = factor(ATTRIBUTE,
                                   levels = c("LUXURY", "STATUS"),
                                   labels = labels))) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode associated with {Luxury, Status}") +
  ylab("Primary mode of travel") +
  scale_fill_viridis_d(direction = -1) +
  facet_grid(EDUCATION ~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```

### 4.2.3 Income

Words go here to discuss results by income.

```{r figure-mosaic-plots-by-attribute-and-income, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:mosaic-plots-by-income}Mosaic plots for affective values by income; the y-axis is the proportion of respondents by main mode of transportation, and the x-axis is the proportion of modes selected for each value (p-values are for Cochran-Mantel-Haenszel Chi-Squared Test)"}

# Select only values that were significant in the tests of independence

# Also, use Cochran-Mantel-Haenzel tests
# Poverty
Modes_by_Poverty_by_Income <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + INCOME, data = filter(Modes_by_Attribute, ATTRIBUTE == "POVERTY")))

# Luxury
Modes_by_Luxury_by_Income <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + INCOME, data = filter(Modes_by_Attribute, ATTRIBUTE == "LUXURY")))

# Status
Modes_by_Status_by_Income <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + INCOME, data = filter(Modes_by_Attribute, ATTRIBUTE == "STATUS")))

labels <- c(paste('POVERTY\np-value', ifelse(round(Modes_by_Poverty_by_Income$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Poverty_by_Income$p.value, 3)),
                                             " < 0.001")),
            paste('LUXURY\np-value', ifelse(round(Modes_by_Luxury_by_Income$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Luxury_by_Income$p.value, 3)),
                                             " < 0.001")),
            paste('STATUS\np-value', ifelse(round(Modes_by_Status_by_Income$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Status_by_Income$p.value, 3)),
                                             " < 0.001")))


ggplot(data = Modes_by_Attribute %>% 
         filter(ATTRIBUTE %in% c("POVERTY", "LUXURY", "STATUS")) %>%
         mutate(ATTRIBUTE = factor(ATTRIBUTE, 
                                   levels = c("POVERTY", "LUXURY", "STATUS"),
                                   labels = labels))) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode associated with {Poverty, Luxury, Status}") +
  ylab("Primary mode of travel") +
  scale_fill_viridis_d(direction = -1) +
  facet_grid(INCOME ~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```

### 4.3.4 Typical commute time

Words go here to discuss results by time.

```{r figure-mosaic-plots-by-attribute-and-time, echo=FALSE, cache = TRUE,  fig.cap="\\label{fig:mosaic-plots-by-travel-time}Mosaic plots for affective values by commute time; the y-axis is the proportion of respondents by main mode of transportation, and the x-axis is the proportion of modes selected for each value (p-values are for Cochran-Mantel-Haenszel Chi-Squared Test)"}

# Select only affective values that were significant in the tests of independence

# Also, use Cochran-Mantel-Haenzel tests
# Freedom
Modes_by_Freedom_by_Time <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + TRAVEL_TIME, data = filter(Modes_by_Attribute, ATTRIBUTE == "FREEDOM")))

# Happiness
Modes_by_Happiness_by_Time <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + TRAVEL_TIME, data = filter(Modes_by_Attribute, ATTRIBUTE == "HAPPINESS")))

# Luxury
Modes_by_Luxury_by_Time <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + TRAVEL_TIME, data = filter(Modes_by_Attribute, ATTRIBUTE == "LUXURY")))

# Status
Modes_by_Status_by_Time <- mantelhaen.test(xtabs(WEIGHT ~ USED + IDEAL + TRAVEL_TIME, data = filter(Modes_by_Attribute, ATTRIBUTE == "STATUS")))

labels <- c(paste('FREEDOM\np-value', ifelse(round(Modes_by_Freedom_by_Time$p.value, 2) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Time$p.value, 3)),
                                             " < 0.001")),
            paste('ENJOYMENT\np-value', ifelse(round(Modes_by_Freedom_by_Time$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Time$p.value, 3)),
                                             " < 0.001")),
            paste('LUXURY\np-value', ifelse(round(Modes_by_Freedom_by_Time$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Time$p.value, 3)),
                                             " < 0.001")),
            paste('STATUS\np-value', ifelse(round(Modes_by_Freedom_by_Time$p.value, 3) >= 0.001,
                                             paste("=", round(Modes_by_Freedom_by_Time$p.value, 3)),
                                             " < 0.001")))



ggplot(data = Modes_by_Attribute %>% 
         filter(ATTRIBUTE %in% c("FREEDOM", "HAPPINESS", "LUXURY", "STATUS")) %>% drop_na(TRAVEL_TIME) %>%
         mutate(ATTRIBUTE = factor(ATTRIBUTE, 
                                   levels = c("FREEDOM", "HAPPINESS", "LUXURY", "STATUS"),
                                   labels = labels))) + 
  geom_mosaic(aes(product(IDEAL, USED), fill = IDEAL, weight = WEIGHT),
              divider = mosaic("vertical")) + 
  xlab("Mode associated with {Freedom, Happiness, Luxury, Status}") +
  ylab("Primary mode of travel") +
  scale_fill_viridis_d(direction = -1) +
  facet_grid(TRAVEL_TIME ~ ATTRIBUTE) +
  theme_tufte() +
  theme(axis.text.x = element_text(angle = 90))
```

***FOR DISCUSSION***

@Devos2018people


5. Conclusions
==========

Accordingly, the aim of this paper is to analyse some of the factors that can potentially affect the levels of SWB in the wide spectrum of public, private and active transport modes in the context of Santiago de Chile. Previous research suggests that public transport users experience a negative gap in desired and actual travel time, whereas active travellers don’t seem to mind somewhat longer trips than what strictly needed (e.g., Páez and Whalen, 2010). In the context of a Latin American country, historically the poor travel experience of public transit users and active travellers reflects the social inequalities of social groups that have no alternative but to move in these types of modes while living far from the work centres and main activities. The paper aims to reflect on the possibilities of increasing the SWB while travelling, and how this could increase the attractiveness of public transport and active travel in the socio-demographic groups studied. This can help not only to reduce the use of private transport but also decrease the inequality gap between these users.

The paper explores how positive affective and instrumental/utilitarian factors of SWB correspond to the use of the primary mode of transportation. It uses an analysis of correspondence that considers the actual primary mode versus the mode that individuals associated to both utilitarian (designed to be useful or practical rather than attractive) and affective (expressing a person's feelings) SWB factors. For example, it will be analysed if a person who uses public transport as the primary mode, tends to associate these modes with positive affective factors (as freedom, enjoyment or happiness) or positive utilitarian factors (as security, time-savings or efficiency). We hypothesize that there is a more persistent non-correspondence or mismatch within the more disadvantage groups or within the users of public transport.

Acknowledgments
==========

The following `R` packages were used in the course of this investigation and the authors wish to acknowledge their developers: `ggmosaic` [@Jeppson2019ggmosaic], `ggthemes` [@Arnold2018], `kableExtra` [@Zhu2018], `knitr` [@Xie2015; @Xie2018], `rticles` [@Allaire2018rticles], and `tidyverse` [@Wickham2017].

References {#references .unnumbered}
==========
